# Диаграмма базы данных "Университет" - Расширенная версия

## Структура таблиц
┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ faculties │ │ students │ │ grades │
├─────────────┤ ├─────────────┤ ├─────────────┤
│ faculty_id │◄──────│ faculty_id │ │ student_id │
│ faculty_name│ │ student_id │◄──────│ course_id │
│ dean_name │ │ first_name │ │ grade │
│ created_at │ │ last_name │ │ exam_date │
└─────────────┘ │ email │ │ created_at │
│ │ enrollment_ │ └─────────────┘
│ │ created_at │ ▲
│ └─────────────┘ │
│ │ │
│ │ │
▼ ▼ │
┌─────────────┐ ┌─────────────┐ │
│ courses │ │ indexes │ │
├─────────────┤ ├─────────────┤ │
│ course_id │◄───│ idx_students│ │
│ course_name │ │ idx_grades │ │
│ description │ │ idx_courses │ │
│ credits │ └─────────────┘ │
│ created_at │ │
└─────────────┘ │
│
┌──────────────┴──────────┐
│ TRIGGERS │
├────────────────────────┤
│ validate_student_email │
│ generate_sample_data │
└────────────────────────┘



## Описание связей

### Основные связи:
1. **faculties → students** (один-ко-многим)
   - Один факультет имеет много студентов
   - Связь через `faculty_id`

2. **students → grades ← courses** (многие-ко-многим)
   - Студент может иметь много оценок по разным курсам
   - Курс может иметь много студентов с оценками
   - Связь через таблицу `grades`

### Новые элементы:

####  Индексы (для производительности):
- `idx_students_faculty` - поиск студентов по факультету
- `idx_grades_student` - поиск оценок по студенту  
- `idx_grades_course` - поиск оценок по курсу
- `idx_grades_date` - поиск по дате экзамена
- `idx_students_name` - поиск студентов по ФИО

####  Триггеры:
- `validate_student_email` - проверка формата email при добавлении студента
- `generate_sample_data` - функция для автоматического заполнения тестовыми данными

####  Ограничения (Constraints):
- **NOT NULL** - обязательные поля
- **UNIQUE** - уникальные email студентов и названия факультетов
- **CHECK** - проверка диапазонов (оценки 1-5, кредиты 1-10, год поступления 2000-2024)
- **DEFAULT** - автоматическое проставление даты создания

####  Производительность:
- Все запросы используют индексы
- Добавлен `EXPLAIN ANALYZE` для тестирования скорости выполнения

## Примеры запросов с оптимизацией:

1. **Средний балл по факультетам** - использует индексы для быстрой агрегации
2. **Студенты с высоким баллом** - фильтрация через WHERE + GROUP BY  
3. **Популярные курсы** - подсчет через COUNT с использованием индексов

##  Что обеспечивает расширенная версия:

- **Автоматическое развертывание** через Docker Compose
- **Производительность** через индексы и оптимизацию
- **Целостность данных** через триггеры и ограничения
- **Масштабируемость** - поддержка больших объемов данных
- **Тестирование** - встроенные тесты производительности